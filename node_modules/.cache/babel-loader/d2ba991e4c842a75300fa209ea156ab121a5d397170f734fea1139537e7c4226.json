{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/DELL/Desktop/ReactMeals/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/DELL/Desktop/ReactMeals/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/DELL/Desktop/ReactMeals/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/DELL/Desktop/ReactMeals/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState}from\"react\";import CardContext from\"../../store/card-context\";import CartItem from\"./CartItem\";import Modal from\"../UI/Modal\";import styles from\"./Card.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Card=function Card(props){var _useState=useState({btnNew:false,btnValue:\"Order\"}),_useState2=_slicedToArray(_useState,2),btnOrder=_useState2[0],setBtnOrder=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),orderError=_useState4[0],setOrderError=_useState4[1];var cardCtx=useContext(CardContext);var showLogMasseg=cardCtx.showLogMasseg,onShowLogMasseg=cardCtx.onShowLogMasseg,userDataForOrder=cardCtx.userDataForOrder;var orderHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!props.logState){_context.next=22;break;}if(!(btnOrder.btnValue===\"Order\"||btnOrder.btnValue===\"Try again\")){_context.next=19;break;}setBtnOrder(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{btnValue:\"Ordering..\"});});_context.prev=3;setOrderError(null);_context.next=7;return fetch(\"https://reactmeals-80774-default-rtdb.firebaseio.com/order.json\",{method:\"POST\",body:JSON.stringify({userData:userDataForOrder,orderdItems:cardCtx.items}),headers:{\"content-type\":\"application/json\"}});case 7:response=_context.sent;if(response.ok){_context.next=10;break;}throw new Error(\"\");case 10:setBtnOrder(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{btnNew:true,btnValue:\"New Order\"});});_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](3);setOrderError(\"Somthing went wrong\");setBtnOrder(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{btnNew:false,btnValue:\"Try again\"});});case 17:_context.next=20;break;case 19:if(btnOrder.btnValue===\"New Order\"){props.onHideCard();cardCtx.newOrder();}case 20:_context.next=23;break;case 22:onShowLogMasseg(true);case 23:case\"end\":return _context.stop();}},_callee,null,[[3,13]]);}));return function orderHandler(){return _ref.apply(this,arguments);};}();var logInHandler=function logInHandler(){props.onClickLog();props.onLogIn();};var closeHandler=function closeHandler(){props.onHideCard();btnOrder.btnNew&&cardCtx.newOrder();};var cardItemRemoveHandler=function cardItemRemoveHandler(id){cardCtx.removeItem(id);};var cardItemAddHandler=function cardItemAddHandler(item){cardCtx.addItem(_objectSpread(_objectSpread({},item),{},{amount:1}));};var totalAmount=\"$\".concat(cardCtx.totalAmount.toFixed(2));var hasItems=cardCtx.items.length>0;var cardItems=cardCtx.items.map(function(item){return/*#__PURE__*/_jsx(CartItem,{name:item.name,amount:item.amount,price:item.price,onRemove:cardItemRemoveHandler.bind(null,item.id),onAdd:cardItemAddHandler.bind(null,item),disabelBtn:btnOrder.btnNew},item.id);});return/*#__PURE__*/_jsx(Modal,{onClose:closeHandler,id:\"orderCard\",children:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"ul\",{className:styles[\"cart-items\"],children:cardItems}),/*#__PURE__*/_jsxs(\"div\",{className:styles.total,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total\"}),/*#__PURE__*/_jsx(\"span\",{children:totalAmount})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.actions,children:[!showLogMasseg&&/*#__PURE__*/_jsx(\"button\",{className:styles[\"button--alt\"],onClick:closeHandler,children:\"Close\"}),hasItems&&!showLogMasseg&&/*#__PURE__*/_jsx(\"button\",{className:styles.button,onClick:orderHandler,disabled:btnOrder.btnValue===\"Ordering..\",children:btnOrder.btnValue})]}),btnOrder.btnNew&&/*#__PURE__*/_jsx(\"p\",{className:styles[\"final-masseg\"],children:\"Thank you for using our website, you will receive your order in about 30 minutes...\"}),orderError&&/*#__PURE__*/_jsxs(\"p\",{className:styles[\"final-masseg\"],children:[orderError,\", Try again\"]}),showLogMasseg&&/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.actions,\" \").concat(styles[\"actions-center\"]),children:[/*#__PURE__*/_jsx(\"p\",{children:\"You need to log in first\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.buttons,children:[/*#__PURE__*/_jsx(\"button\",{className:styles.button,onClick:logInHandler,children:\"Log in\"}),/*#__PURE__*/_jsx(\"button\",{className:styles[\"button--alt\"],onClick:props.onHideCard,children:\"Close\"})]})]})]})});};export default Card;","map":{"version":3,"names":["useContext","useState","CardContext","CartItem","Modal","styles","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Card","props","_useState","btnNew","btnValue","_useState2","_slicedToArray","btnOrder","setBtnOrder","_useState3","_useState4","orderError","setOrderError","cardCtx","showLogMasseg","onShowLogMasseg","userDataForOrder","orderHandler","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","logState","prevState","_objectSpread","fetch","method","body","JSON","stringify","userData","orderdItems","items","headers","sent","ok","Error","t0","onHideCard","newOrder","stop","apply","arguments","logInHandler","onClickLog","onLogIn","closeHandler","cardItemRemoveHandler","id","removeItem","cardItemAddHandler","item","addItem","amount","totalAmount","concat","toFixed","hasItems","length","cardItems","map","name","price","onRemove","bind","onAdd","disabelBtn","onClose","children","className","total","actions","onClick","button","disabled","buttons"],"sources":["C:/Users/DELL/Desktop/ReactMeals/src/components/Card/Card.js"],"sourcesContent":["import { useContext, useState } from \"react\";\r\nimport CardContext from \"../../store/card-context\";\r\n\r\nimport CartItem from \"./CartItem\";\r\nimport Modal from \"../UI/Modal\";\r\nimport styles from \"./Card.module.css\";\r\n\r\nconst Card = (props) => {\r\n  const [btnOrder, setBtnOrder] = useState({\r\n    btnNew: false,\r\n    btnValue: \"Order\",\r\n  });\r\n\r\n  const [orderError, setOrderError] = useState(null);\r\n\r\n  const cardCtx = useContext(CardContext);\r\n  const { showLogMasseg, onShowLogMasseg, userDataForOrder } = cardCtx;\r\n\r\n  const orderHandler = async () => {\r\n    if (props.logState) {\r\n      if (btnOrder.btnValue === \"Order\" || btnOrder.btnValue === \"Try again\") {\r\n        setBtnOrder((prevState) => {\r\n          return { ...prevState, btnValue: \"Ordering..\" };\r\n        });\r\n        try {\r\n          setOrderError(null);\r\n          const response = await fetch(\r\n            \"https://reactmeals-80774-default-rtdb.firebaseio.com/order.json\",\r\n            {\r\n              method: \"POST\",\r\n              body: JSON.stringify({\r\n                userData: userDataForOrder,\r\n                orderdItems: cardCtx.items,\r\n              }),\r\n              headers: { \"content-type\": \"application/json\" },\r\n            }\r\n          );\r\n\r\n          if (!response.ok) {\r\n            throw new Error(\"\");\r\n          }\r\n\r\n          setBtnOrder((prevState) => {\r\n            return { ...prevState, btnNew: true, btnValue: \"New Order\" };\r\n          });\r\n        } catch (err) {\r\n          setOrderError(\"Somthing went wrong\");\r\n          setBtnOrder((prevState) => {\r\n            return { ...prevState, btnNew: false, btnValue: \"Try again\" };\r\n          });\r\n        }\r\n      } else if (btnOrder.btnValue === \"New Order\") {\r\n        props.onHideCard();\r\n        cardCtx.newOrder();\r\n      }\r\n    } else {\r\n      onShowLogMasseg(true);\r\n    }\r\n  };\r\n\r\n  const logInHandler = () => {\r\n    props.onClickLog();\r\n    props.onLogIn();\r\n  };\r\n\r\n  const closeHandler = () => {\r\n    props.onHideCard();\r\n    btnOrder.btnNew && cardCtx.newOrder();\r\n  };\r\n\r\n  const cardItemRemoveHandler = (id) => {\r\n    cardCtx.removeItem(id);\r\n  };\r\n\r\n  const cardItemAddHandler = (item) => {\r\n    cardCtx.addItem({ ...item, amount: 1 });\r\n  };\r\n\r\n  const totalAmount = `$${cardCtx.totalAmount.toFixed(2)}`;\r\n  const hasItems = cardCtx.items.length > 0;\r\n  const cardItems = cardCtx.items.map((item) => (\r\n    <CartItem\r\n      key={item.id}\r\n      name={item.name}\r\n      amount={item.amount}\r\n      price={item.price}\r\n      onRemove={cardItemRemoveHandler.bind(null, item.id)}\r\n      onAdd={cardItemAddHandler.bind(null, item)}\r\n      disabelBtn={btnOrder.btnNew}\r\n    />\r\n  ));\r\n\r\n  return (\r\n    <Modal onClose={closeHandler} id=\"orderCard\">\r\n      <>\r\n        <ul className={styles[\"cart-items\"]}>{cardItems}</ul>\r\n        <div className={styles.total}>\r\n          <span>Total</span>\r\n          <span>{totalAmount}</span>\r\n        </div>\r\n        <div className={styles.actions}>\r\n          {!showLogMasseg && (\r\n            <button className={styles[\"button--alt\"]} onClick={closeHandler}>\r\n              Close\r\n            </button>\r\n          )}\r\n          {hasItems && !showLogMasseg && (\r\n            <button\r\n              className={styles.button}\r\n              onClick={orderHandler}\r\n              disabled={btnOrder.btnValue === \"Ordering..\"}\r\n            >\r\n              {btnOrder.btnValue}\r\n            </button>\r\n          )}\r\n        </div>\r\n        {btnOrder.btnNew && (\r\n          <p className={styles[\"final-masseg\"]}>\r\n            Thank you for using our website, you will receive your order in\r\n            about 30 minutes...\r\n          </p>\r\n        )}\r\n        {orderError && (\r\n          <p className={styles[\"final-masseg\"]}>{orderError}, Try again</p>\r\n        )}\r\n        {showLogMasseg && (\r\n          <div className={`${styles.actions} ${styles[\"actions-center\"]}`}>\r\n            <p>You need to log in first</p>\r\n            <div className={styles.buttons}>\r\n              <button className={styles.button} onClick={logInHandler}>\r\n                Log in\r\n              </button>\r\n              <button\r\n                className={styles[\"button--alt\"]}\r\n                onClick={props.onHideCard}\r\n              >\r\n                Close\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default Card;\r\n"],"mappings":"ueAAA,OAASA,UAAU,CAAEC,QAAQ,KAAQ,OAAO,CAC5C,MAAO,CAAAC,WAAW,KAAM,0BAA0B,CAElD,MAAO,CAAAC,QAAQ,KAAM,YAAY,CACjC,MAAO,CAAAC,KAAK,KAAM,aAAa,CAC/B,MAAO,CAAAC,MAAM,KAAM,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAEvC,GAAM,CAAAC,IAAI,CAAG,QAAP,CAAAA,IAAIA,CAAIC,KAAK,CAAK,CACtB,IAAAC,SAAA,CAAgCb,QAAQ,CAAC,CACvCc,MAAM,CAAE,KAAK,CACbC,QAAQ,CAAE,OACZ,CAAC,CAAC,CAAAC,UAAA,CAAAC,cAAA,CAAAJ,SAAA,IAHKK,QAAQ,CAAAF,UAAA,IAAEG,WAAW,CAAAH,UAAA,IAK5B,IAAAI,UAAA,CAAoCpB,QAAQ,CAAC,IAAI,CAAC,CAAAqB,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA3CE,UAAU,CAAAD,UAAA,IAAEE,aAAa,CAAAF,UAAA,IAEhC,GAAM,CAAAG,OAAO,CAAGzB,UAAU,CAACE,WAAW,CAAC,CACvC,GAAQ,CAAAwB,aAAa,CAAwCD,OAAO,CAA5DC,aAAa,CAAEC,eAAe,CAAuBF,OAAO,CAA7CE,eAAe,CAAEC,gBAAgB,CAAKH,OAAO,CAA5BG,gBAAgB,CAExD,GAAM,CAAAC,YAAY,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,MAAAC,QAAA,QAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,aACf3B,KAAK,CAAC4B,QAAQ,EAAAH,QAAA,CAAAE,IAAA,gBACZrB,QAAQ,CAACH,QAAQ,GAAK,OAAO,EAAIG,QAAQ,CAACH,QAAQ,GAAK,WAAW,GAAAsB,QAAA,CAAAE,IAAA,WACpEpB,WAAW,CAAC,SAACsB,SAAS,CAAK,CACzB,OAAAC,aAAA,CAAAA,aAAA,IAAYD,SAAS,MAAE1B,QAAQ,CAAE,YAAY,GAC/C,CAAC,CAAC,CAACsB,QAAA,CAAAC,IAAA,GAEDf,aAAa,CAAC,IAAI,CAAC,CAACc,QAAA,CAAAE,IAAA,SACG,CAAAI,KAAK,CAC1B,iEAAiE,CACjE,CACEC,MAAM,CAAE,MAAM,CACdC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,QAAQ,CAAErB,gBAAgB,CAC1BsB,WAAW,CAAEzB,OAAO,CAAC0B,KACvB,CAAC,CAAC,CACFC,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAmB,CAChD,CACF,CAAC,QAVKjB,QAAQ,CAAAG,QAAA,CAAAe,IAAA,IAYTlB,QAAQ,CAACmB,EAAE,EAAAhB,QAAA,CAAAE,IAAA,gBACR,IAAI,CAAAe,KAAK,CAAC,EAAE,CAAC,SAGrBnC,WAAW,CAAC,SAACsB,SAAS,CAAK,CACzB,OAAAC,aAAA,CAAAA,aAAA,IAAYD,SAAS,MAAE3B,MAAM,CAAE,IAAI,CAAEC,QAAQ,CAAE,WAAW,GAC5D,CAAC,CAAC,CAACsB,QAAA,CAAAE,IAAA,kBAAAF,QAAA,CAAAC,IAAA,IAAAD,QAAA,CAAAkB,EAAA,CAAAlB,QAAA,aAEHd,aAAa,CAAC,qBAAqB,CAAC,CACpCJ,WAAW,CAAC,SAACsB,SAAS,CAAK,CACzB,OAAAC,aAAA,CAAAA,aAAA,IAAYD,SAAS,MAAE3B,MAAM,CAAE,KAAK,CAAEC,QAAQ,CAAE,WAAW,GAC7D,CAAC,CAAC,CAAC,QAAAsB,QAAA,CAAAE,IAAA,kBAEA,GAAIrB,QAAQ,CAACH,QAAQ,GAAK,WAAW,CAAE,CAC5CH,KAAK,CAAC4C,UAAU,CAAC,CAAC,CAClBhC,OAAO,CAACiC,QAAQ,CAAC,CAAC,CACpB,CAAC,QAAApB,QAAA,CAAAE,IAAA,kBAEDb,eAAe,CAAC,IAAI,CAAC,CAAC,yBAAAW,QAAA,CAAAqB,IAAA,MAAAzB,OAAA,iBAEzB,kBAxCK,CAAAL,YAAYA,CAAA,SAAAC,IAAA,CAAA8B,KAAA,MAAAC,SAAA,OAwCjB,CAED,GAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAA,CAAS,CACzBjD,KAAK,CAACkD,UAAU,CAAC,CAAC,CAClBlD,KAAK,CAACmD,OAAO,CAAC,CAAC,CACjB,CAAC,CAED,GAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAA,CAAS,CACzBpD,KAAK,CAAC4C,UAAU,CAAC,CAAC,CAClBtC,QAAQ,CAACJ,MAAM,EAAIU,OAAO,CAACiC,QAAQ,CAAC,CAAC,CACvC,CAAC,CAED,GAAM,CAAAQ,qBAAqB,CAAG,QAAxB,CAAAA,qBAAqBA,CAAIC,EAAE,CAAK,CACpC1C,OAAO,CAAC2C,UAAU,CAACD,EAAE,CAAC,CACxB,CAAC,CAED,GAAM,CAAAE,kBAAkB,CAAG,QAArB,CAAAA,kBAAkBA,CAAIC,IAAI,CAAK,CACnC7C,OAAO,CAAC8C,OAAO,CAAA5B,aAAA,CAAAA,aAAA,IAAM2B,IAAI,MAAEE,MAAM,CAAE,CAAC,EAAE,CAAC,CACzC,CAAC,CAED,GAAM,CAAAC,WAAW,KAAAC,MAAA,CAAOjD,OAAO,CAACgD,WAAW,CAACE,OAAO,CAAC,CAAC,CAAC,CAAE,CACxD,GAAM,CAAAC,QAAQ,CAAGnD,OAAO,CAAC0B,KAAK,CAAC0B,MAAM,CAAG,CAAC,CACzC,GAAM,CAAAC,SAAS,CAAGrD,OAAO,CAAC0B,KAAK,CAAC4B,GAAG,CAAC,SAACT,IAAI,qBACvC/D,IAAA,CAACJ,QAAQ,EAEP6E,IAAI,CAAEV,IAAI,CAACU,IAAK,CAChBR,MAAM,CAAEF,IAAI,CAACE,MAAO,CACpBS,KAAK,CAAEX,IAAI,CAACW,KAAM,CAClBC,QAAQ,CAAEhB,qBAAqB,CAACiB,IAAI,CAAC,IAAI,CAAEb,IAAI,CAACH,EAAE,CAAE,CACpDiB,KAAK,CAAEf,kBAAkB,CAACc,IAAI,CAAC,IAAI,CAAEb,IAAI,CAAE,CAC3Ce,UAAU,CAAElE,QAAQ,CAACJ,MAAO,EANvBuD,IAAI,CAACH,EAOX,CAAC,EACH,CAAC,CAEF,mBACE5D,IAAA,CAACH,KAAK,EAACkF,OAAO,CAAErB,YAAa,CAACE,EAAE,CAAC,WAAW,CAAAoB,QAAA,cAC1C9E,KAAA,CAAAE,SAAA,EAAA4E,QAAA,eACEhF,IAAA,OAAIiF,SAAS,CAAEnF,MAAM,CAAC,YAAY,CAAE,CAAAkF,QAAA,CAAET,SAAS,CAAK,CAAC,cACrDrE,KAAA,QAAK+E,SAAS,CAAEnF,MAAM,CAACoF,KAAM,CAAAF,QAAA,eAC3BhF,IAAA,SAAAgF,QAAA,CAAM,OAAK,CAAM,CAAC,cAClBhF,IAAA,SAAAgF,QAAA,CAAOd,WAAW,CAAO,CAAC,EACvB,CAAC,cACNhE,KAAA,QAAK+E,SAAS,CAAEnF,MAAM,CAACqF,OAAQ,CAAAH,QAAA,EAC5B,CAAC7D,aAAa,eACbnB,IAAA,WAAQiF,SAAS,CAAEnF,MAAM,CAAC,aAAa,CAAE,CAACsF,OAAO,CAAE1B,YAAa,CAAAsB,QAAA,CAAC,OAEjE,CAAQ,CACT,CACAX,QAAQ,EAAI,CAAClD,aAAa,eACzBnB,IAAA,WACEiF,SAAS,CAAEnF,MAAM,CAACuF,MAAO,CACzBD,OAAO,CAAE9D,YAAa,CACtBgE,QAAQ,CAAE1E,QAAQ,CAACH,QAAQ,GAAK,YAAa,CAAAuE,QAAA,CAE5CpE,QAAQ,CAACH,QAAQ,CACZ,CACT,EACE,CAAC,CACLG,QAAQ,CAACJ,MAAM,eACdR,IAAA,MAAGiF,SAAS,CAAEnF,MAAM,CAAC,cAAc,CAAE,CAAAkF,QAAA,CAAC,qFAGtC,CAAG,CACJ,CACAhE,UAAU,eACTd,KAAA,MAAG+E,SAAS,CAAEnF,MAAM,CAAC,cAAc,CAAE,CAAAkF,QAAA,EAAEhE,UAAU,CAAC,aAAW,EAAG,CACjE,CACAG,aAAa,eACZjB,KAAA,QAAK+E,SAAS,IAAAd,MAAA,CAAKrE,MAAM,CAACqF,OAAO,MAAAhB,MAAA,CAAIrE,MAAM,CAAC,gBAAgB,CAAC,CAAG,CAAAkF,QAAA,eAC9DhF,IAAA,MAAAgF,QAAA,CAAG,0BAAwB,CAAG,CAAC,cAC/B9E,KAAA,QAAK+E,SAAS,CAAEnF,MAAM,CAACyF,OAAQ,CAAAP,QAAA,eAC7BhF,IAAA,WAAQiF,SAAS,CAAEnF,MAAM,CAACuF,MAAO,CAACD,OAAO,CAAE7B,YAAa,CAAAyB,QAAA,CAAC,QAEzD,CAAQ,CAAC,cACThF,IAAA,WACEiF,SAAS,CAAEnF,MAAM,CAAC,aAAa,CAAE,CACjCsF,OAAO,CAAE9E,KAAK,CAAC4C,UAAW,CAAA8B,QAAA,CAC3B,OAED,CAAQ,CAAC,EACN,CAAC,EACH,CACN,EACD,CAAC,CACE,CAAC,CAEZ,CAAC,CAED,cAAe,CAAA3E,IAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}